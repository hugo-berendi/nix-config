based on [everything-nix](https://github.com/prescientmoon/everything-nix)